L = rbinom(2,0.5,100)
L
L = rbinom(100, 2, 0.5)
L
L = rbinom(100, 1, 0.5)
L
A = 5*L + rnorm(100)
plot(A ~ L)
B = -5 + 8*sin(A) + rnorm(100)
plot(A, B)
A = 5*L + rnorm(100,0,0.5)
B = -5 + 8*sin(A) + rnorm(100,0,0.5)
plot(A, B)
library(ggplot)
library(ggplot2)
df = cbind(L, A, B)
A = -2 + 3*L + rnorm(100,0,0.5)
B = -5 + 8*sin(A) + rnorm(100,0,0.5)
df = cbind(L, A, B)
ggplot(df, aes(A,B,color=L)) + geom_point()
df = as.data.frame(df)
ggplot(df, aes(A,B,color=L)) + geom_point()
A = -2 + 3*L - rnorm(100,0,0.5)
B = -5 + 8*sin(A) + rnorm(100,0,0.5)
ggplot(df, aes(A,B,color=L)) + geom_point()
df = as.data.frame(cbind(L,A,B))
ggplot(df, aes(A,B,color=L)) + geom_point()
?rnorm
L = rbinom(1000, 1, 0.5)
A = -2 + 3*L - rnorm(1000,0,0.5)
B = -5 + 8*sin(A) + rnorm(1000,0,0.5)
df = as.data.frame(cbind(L,A,B))
ggplot(df, aes(A,B,color=L)) + geom_point()
ggplot(df, aes(A,B,color=L)) + geom_point() + stat_smooth(method="lm")
library(cit)
install.packages("cit")
library(cit)
cit.cp(L, A, B)
Bresid = resid(lm(B ~ A))
df = as.data.frame(cbind(L,A,B,Bresid))
ggplot(df, aes(A,Bresid,color=L)) + geom_point()
Bresid2 = B - 8*sin(A)
df = as.data.frame(cbind(L,A,B,Bresid, Bresid2))
ggplot(df, aes(A,Bresid2,color=L)) + geom_point()
A = -2 + 3*L - rnorm(1000,0,1)
B = -5 + 8*sin(A) + rnorm(1000,0,0.5)
df = as.data.frame(cbind(L,A,B))
ggplot(df, aes(A,B,color=L)) + geom_point()
ggplot(df, aes(A,B,color=L)) + geom_point() + stat_smooth(method="lm")
cit.cp(L, A, B)
Bresid = resid(lm(B ~ A))
df = as.data.frame(cbind(L,A,B,Bresid))
ggplot(df, aes(A,Bresid,color=L)) + geom_point() + stat_smooth(method="lm")
ggplot(df, aes(A,Bresid,color=L)) + geom_point() + stat_smooth(method="lm", aes(group=L))
ggplot(df, aes(A,Bresid,color=L)) + geom_point() + stat_smooth(method="lm")
B,Bresid, Bresid2))
cit.cp(L[1:100], A[1:100], B[1:100])
Bresid2 = B - 8*sin(A)
summary(lm(Bresid2 ~ L))
summary(lm(Bresid2[1:100] ~ L[1:100]))
ggplot(df, aes(A,Bresid2,color=L)) + geom_point() + stat_smooth(method="lm")
ggplot(df, aes(A[1:100],Bresid2[1:100],color=L)) + geom_point() + stat_smooth(method="lm")
ggplot(df, aes(a[1:100],Bresid2[1:100],color=L)) + geom_point() + stat_smooth(method="lm")
ggplot(df[1:100,], aes(A,Bresid2,color=L)) + geom_point() + stat_smooth(method="lm")
2,color=L)) + geom_point() + stat_smooth(method="lm")
head(df)
df = as.data.frame(cbind(L,A,B,Bresid, Bresid2))
ggplot(df[1:100,], aes(A,Bresid2,color=L)) + geom_point() + stat_smooth(method="lm")
ggplot(df[1:100,], aes(A,Bresid,color=L)) + geom_point() + stat_smooth(method="lm")
ggplot(df[1:100,], aes(L,Bresid)) + geom_point() + stat_smooth(method="lm")
df$L = as.factor(df$L)
ggplot(df[1:100,], aes(L,Bresid)) + geom_point() + stat_smooth(method="lm")
ggplot(df[1:100,], aes(L,Bresid)) + geom_boxplot() + stat_smooth(method="lm")
ggplot(df[1:100,], aes(L,Bresid)) + geom_boxplot(notch=TRUE) + stat_smooth(method="lm")
ggplot(df[sample(nrow(df),100),], aes(L,Bresid)) + geom_boxplot(notch=TRUE) + stat_smooth(method="lm")
ggplot(df, aes(L,Bresid)) + geom_boxplot(notch=TRUE) + stat_smooth(method="lm")
Bresid = resid(lm(df$B ~ df$A))
df$Bresid = Bresid
ggplot(df, aes(L,Bresid)) + geom_boxplot(notch=TRUE) + stat_smooth(method="lm")
ggplot(df, aes(A,Bresid,color=L)) + geom_point() + stat_smooth(method="lm")
ggplot(df, aes(A,Bresid,color=L)) + geom_point() + stat_smooth(method="lm", aes(group=1))
ggplot(df, aes(L,Bresid)) + geom_boxplot(notch=TRUE) + stat_smooth(method="lm")
ggplot(df, aes(L,Bresid2)) + geom_boxplot(notch=TRUE) + stat_smooth(method="lm")
ggplot(df, aes(L,Bresid)) + geom_boxplot(notch=TRUE) + stat_smooth(method="lm")
cit.cp(L,A,B)
with(df[1:100,], cit.cp(L,A,B))
with(df[1:200,], cit.cp(L,A,B))
with(df[1:300,], cit.cp(L,A,B))
with(df[sample(nrow(df), 50),], cit.cp(L,A,B))
ggplot(df, aes(A,B,color=L)) + geom_point() + stat_smooth(method="lm"
)
with(df[1:50,], cit.cp(L,A,B))
ggplot(df[1:50,], aes(A,B,color=L)) + geom_point() + stat_smooth(method="lm")
with(df[1:100,], cor.test(A[L==0], B[L==0]))
with(df[1:100,], cor.test(A[L==1], B[L==1]))
with(df[1:50,], cor.test(A[L==1], B[L==1]))
with(df[1:50,], cor.test(A[L==0], B[L==0]))
with(df[1:100,], cit.cp(L,A,B))
fit0 = with(df[1:100,], lm(B ~ A))
fit1 = with(df[1:100,], lm(B ~ A + L))
anova(fit0, fit1)
rm(L)
rm(A)
rm(B)
fit1 = with(df[1:100,], lm(B ~ A + L))
fit0 = with(df[1:100,], lm(B ~ A))
anova(fit0, fit1)
lm(B ~ A + L, data=df[1:100,])
fit1 = lm(B ~ A + L, data=df[1:100,])
fit0 = lm(B ~ A, data=df[1:100,])
anova(fit0, fit1)
fit0 = lm(B ~ L, data=df[1:100,])
anova(fit0, fit1)
summary(fit0)
summary(fit1)
plot(fit1)
plot(fit0)
ggplot(df[1:50,], aes(A,B,color=L)) + geom_point() + stat_smooth(method="lm")
savehistory(file="debugging.cit.nlmr.Rhist")
library(ggplot2)
ggplot(df,aes(A,B,color=L))+geom_point()+stat_smooth(method="lm")
L
A
length(L)
length(A)
length(B)
plot(A,B)
df
ggplot(temp,aes(A,B,color=L))+geom_point()+stat_smooth(method="lm")
var(A)
var(A[L==1])
var(A[L==0])
